<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CCP & OPRP – All Sheets</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --brand: #1f4f8b;
      --brand-light: #e5f0ff;
      --brand-dark: #15355e;
      --border: #d6deec;
      --bg: #f3f6fb;
      --text: #1f2933;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 16px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: radial-gradient(circle at top left, #ffffff 0, #f3f6fb 40%, #e6edf9 100%);
      color: var(--text);
    }

    .app-shell {
      max-width: 1500px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.18);
      border: 1px solid rgba(148, 163, 184, 0.4);
      overflow: hidden;
    }

    .app-header {
      padding: 14px 18px;
      background: linear-gradient(135deg, var(--brand), var(--brand-dark));
      color: #f9fafb;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .app-header h1 {
      margin: 0;
      font-size: 18px;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .app-header small {
      font-size: 11px;
      opacity: 0.9;
    }

    .app-header-right {
      text-align: right;
      font-size: 11px;
      opacity: 0.95;
    }

    .tab-header {
      display: flex;
      gap: 0;
      background: #f8fafc;
      border-bottom: 1px solid var(--border);
      overflow-x: auto;
    }

    .tab-header::-webkit-scrollbar {
      height: 6px;
    }
    .tab-header::-webkit-scrollbar-thumb {
      background: #cbd5f5;
      border-radius: 999px;
    }

    .tab-link {
      flex: 1 0 0;
      padding: 10px 16px;
      border: none;
      background: transparent;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      color: #4b5563;
      border-right: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      white-space: nowrap;
      transition: background 0.15s, color 0.15s;
    }

    .tab-link span.badge {
      background: #e5edff;
      color: var(--brand-dark);
      border-radius: 999px;
      padding: 1px 8px;
      font-size: 11px;
      font-weight: 500;
    }

    .tab-link:last-child {
      border-right: none;
    }

    .tab-link:hover {
      background: #edf2ff;
    }

    .tab-link.active {
      background: #ffffff;
      color: var(--brand-dark);
      box-shadow: inset 0 -2px 0 var(--brand);
    }

    .tab-content {
      padding: 14px;
      background: #f5f7fb;
    }

    .tab-pane {
      display: none;
      background: #ffffff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.08);
    }

    .tab-pane.active {
      display: block;
    }

    /* Avoid double page margins inside embedded forms */
    .tab-pane body {
      margin: 0;
      padding: 0;
      background: transparent;
    }

    .tab-pane .page,
    .tab-pane .wrap {
      box-shadow: none;
      border-radius: 8px;
      border: 1px solid rgba(148, 163, 184, 0.4);
    }

    @media (max-width: 768px) {
      body { padding: 8px; }
      .app-header {
        flex-direction: column;
        align-items: flex-start;
      }
      .app-header-right { text-align: left; }
      .tab-link {
        padding: 9px 10px;
        font-size: 12px;
        flex: 0 0 auto;
      }
      .tab-content { padding: 10px; }
      .tab-pane { padding: 10px; }
    }

    @media print {
      body {
        background: #ffffff;
        padding: 0;
      }
      .app-shell {
        box-shadow: none;
        border-radius: 0;
        border: none;
      }
      .app-header,
      .tab-header {
        display: none !important;
      }
      .tab-pane {
        box-shadow: none;
        padding: 0;
      }
    }
  </style>
</head>
<body>

<div class="app-shell">
  <div class="app-header">
    <div>
      <h1>HERITAGE FOODS – CCP & OPRP DIGITAL LOG</h1>
      <small>Single-page access to Market Milk, Buttermilk and Curd verification records</small>
    </div>
    <div class="app-header-right">
      <div>Ref: HFL/PR/COM/R‑17</div>
      <div>Rev No: 01 • Rev Date: 01/08/2022</div>
    </div>
  </div>

  <div class="tab-header">
    <button type="button" class="tab-link active" data-target="sheet1">
      Sheet&nbsp;1 – MM CCP &amp; OPRP <span class="badge">Market Milk</span>
    </button>
    <button type="button" class="tab-link" data-target="sheet2">
      Sheet&nbsp;2 – Buttermilk CCP &amp; OPRP <span class="badge">Butter Milk</span>
    </button>
    <button type="button" class="tab-link" data-target="sheet3">
      Sheet&nbsp;3 – Curd CCP &amp; OPRP <span class="badge">Curd</span>
    </button>
  </div>

  <div class="tab-content">
    <!-- SHEET 1: MM CCP & OPRP -->
    <div id="sheet1" class="tab-pane active">
      <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CCP & OPRP Verification Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; font-family: Arial, sans-serif; }
    body { margin: 0; padding: 16px; background: #f5f7fb; }
    .page {
      max-width: 1400px; margin: auto; background: #fff;
      padding: 20px; border-radius: 6px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 { text-align: center; font-size: 20px; margin-bottom: 10px; }

    .meta-table, .ccp-table { width: 100%; border-collapse: collapse; }
    .meta-table td { padding: 4px; font-size: 13px; }

    .section-labels { display: flex; gap: 12px; flex-wrap: wrap; margin: 12px 0; }
    .section-label span { font-weight: bold; min-width: 70px; }
    .section-label input {
      padding: 4px 6px; border: 1px solid #ccc; border-radius: 3px;
    }

    .table-wrapper {
      overflow-x: auto;
      margin-top: 10px;
    }

    .ccp-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;   /* ✅ Enforces fixed column widths */
    }

    .ccp-table th, .ccp-table td {
      border: 1px solid #ccc;
      padding: 4px;
      font-size: 12px;
      text-align: center;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* ✅ Fixed widths for each column */
    .ccp-table th:nth-child(1), .ccp-table td:nth-child(1) { width: 50px; }   /* S No */
    .ccp-table th:nth-child(2), .ccp-table td:nth-child(2) { width: 120px; }  /* Product */
    .ccp-table th:nth-child(3), .ccp-table td:nth-child(3) { width: 100px; }  /* CCP/OPRP */
    .ccp-table th.req-col, .ccp-table td.req-col {
      min-width: 260px;
      max-width: 260px;
      white-space: normal;
      word-wrap: break-word;
      text-align: left;
    }
    /* ✅ Wider Time/Parameter columns */
    .ccp-table th:nth-child(n+5), .ccp-table td:nth-child(n+5) {
      width: 180px;   /* Increased width for clarity */
    }

    .ccp-table input {
      width: 100%; border: none; padding: 3px; font-size: 12px;
    }

    textarea {
      width: 100%; min-height: 60px; border: 1px solid #ccc;
      border-radius: 4px; padding: 6px;
    }

    .controls {
      display: flex; gap: 8px; justify-content: flex-end;
      margin-top: 10px; flex-wrap: wrap;
    }
    .controls button {
      padding: 6px 12px; border-radius: 4px;
      border: 1px solid #0078d4; background: #0078d4;
      color: #fff; cursor: pointer;
    }
    .controls button.secondary {
      background: #fff; color: #0078d4;
    }

    .status-message {
      text-align: right; font-size: 12px; color: #0078d4;
      min-height: 16px; margin-top: 4px;
    }
  </style>
</head>
<body>
<div class="page">

  <h1>CCP & OPRP VERIFICATION REPORT</h1>

  <table class="meta-table">
    <tr>
      <td>Rev No.</td><td>:</td><td>01</td>
      <td></td>
      <td>Rev Date</td><td>:</td><td>01/08/2022</td>
    </tr>
    <tr>
      <td>Ref No.</td><td>:</td><td>HFL/PR/COM/R - 17</td>
      <td></td>
      <td>Page No.</td><td>:</td><td>3 of 16</td>
    </tr>
  </table>

  <div class="section-labels">
    <div class="section-label">
      <span>Date</span>
      <input type="date" id="date">
    </div>
    <div class="section-label">
      <span>Variant</span>
      <input type="text" id="variant">
    </div>
    <div class="section-label">
      <span>Location</span>
      <input type="text" id="location">
    </div>
  </div>

  <div class="table-wrapper">
    <table class="ccp-table">
      <thead>
        <tr>
          <th rowspan="2">S No</th>
          <th rowspan="2">Product</th>
          <th rowspan="2">CCP / OPRP</th>
          <th rowspan="2" class="req-col">Requirement</th>
          <th colspan="2">Time 1</th>
          <th colspan="2">Time 2</th>
          <th colspan="2">Time 3</th>
          <th colspan="2">Time 4</th>
        </tr>
        <tr>
          <th>Time</th><th>Parameter</th>
          <th>Time</th><th>Parameter</th>
          <th>Time</th><th>Parameter</th>
          <th>Time</th><th>Parameter</th>
        </tr>
      </thead>
      <tbody>
      <tbody>
        <!-- Row 1 -->
        <tr>
          <td>1</td>
          <td><input id="product_1" value="Market Milk"></td>
          <td><input id="ccp_1" value="CCP 01"></td>
          <td class="req-col"><input id="req_1" value="Pasteurization of Milk at 80 ± 3 °C / 15–20 sec"></td>
          <td><input type="time" id="time1_1"></td>
          <td><input id="param1_1"></td>
          <td><input type="time" id="time2_1"></td>
          <td><input id="param2_1"></td>
          <td><input type="time" id="time3_1"></td>
          <td><input id="param3_1"></td>
          <td><input type="time" id="time4_1"></td>
          <td><input id="param4_1"></td>
        </tr>

        <!-- Row 2 -->
        <tr>
          <td>2</td>
          <td><input id="product_2" value="Market Milk"></td>
          <td><input id="ccp_2" value="OPRP 01"></td>
          <td class="req-col"><input id="req_2" value="Checking Integrity of Filter Bags in Packing Machines"></td>
          <td><input type="time" id="time1_2"></td>
          <td><input id="param1_2"></td>
          <td><input type="time" id="time2_2"></td>
          <td><input id="param2_2"></td>
          <td><input type="time" id="time3_2"></td>
          <td><input id="param3_2"></td>
          <td><input type="time" id="time4_2"></td>
          <td><input id="param4_2"></td>
        </tr>

        <!-- Row 3 -->
        <tr>
          <td>3</td>
          <td><input id="product_3" value="Market Milk"></td>
          <td><input id="ccp_3" value="OPRP 02"></td>
          <td class="req-col"><input id="req_3" value="Milk Cold Room Temperature ≤ 5°C"></td>
          <td><input type="time" id="time1_3"></td>
          <td><input id="param1_3"></td>
          <td><input type="time" id="time2_3"></td>
          <td><input id="param2_3"></td>
          <td><input type="time" id="time3_3"></td>
          <td><input id="param3_3"></td>
          <td><input type="time" id="time4_3"></td>
          <td><input id="param4_3"></td>
        </tr>
      </tbody>
    </table>
  </div>
  <h3>Remarks</h3>
  <textarea id="remarks"></textarea>

  <div class="controls">
    <button class="secondary" onclick="clearForm()">Clear</button>
    <button onclick="saveToFile()">Save (Download)</button>
    <button class="secondary" onclick="document.getElementById('fileInput').click()">Load (Upload)</button>
    <input type="file" id="fileInput" accept=".json" style="display:none" onchange="loadFromFile(event)">
  </div>

  <div class="status-message" id="statusMessage"></div>

</div>

<script>
function getRow(i) {
  return {
    product: document.getElementById(`product_${i}`).value,
    ccp: document.getElementById(`ccp_${i}`).value,
    req: document.getElementById(`req_${i}`).value,
    time1: document.getElementById(`time1_${i}`).value,
    param1: document.getElementById(`param1_${i}`).value,
    time2: document.getElementById(`time2_${i}`).value,
    param2: document.getElementById(`param2_${i}`).value,
    time3: document.getElementById(`time3_${i}`).value,
    param3: document.getElementById(`param3_${i}`).value,
    time4: document.getElementById(`time4_${i}`).value,
    param4: document.getElementById(`param4_${i}`).value
  };
}

function setRow(i, row) {
  if (!row) return;
  document.getElementById(`product_${i}`).value = row.product || "";
  document.getElementById(`ccp_${i}`).value = row.ccp || "";
  document.getElementById(`req_${i}`).value = row.req || "";
  document.getElementById(`time1_${i}`).value = row.time1 || "";
  document.getElementById(`param1_${i}`).value = row.param1 || "";
  document.getElementById(`time2_${i}`).value = row.time2 || "";
  document.getElementById(`param2_${i}`).value = row.param2 || "";
  document.getElementById(`time3_${i}`).value = row.time3 || "";
  document.getElementById(`param3_${i}`).value = row.param3 || "";
  document.getElementById(`time4_${i}`).value = row.time4 || "";
  document.getElementById(`param4_${i}`).value = row.param4 || "";
}

function getFormData() {
  return {
    date: date.value,
    variant: variant.value,
    location: location.value,
    remarks: remarks.value,
    rows: [getRow(1), getRow(2), getRow(3)]
  };
}

function setFormData(data) {
  if (!data) return;
  date.value = data.date || "";
  variant.value = data.variant || "";
  location.value = data.location || "";
  remarks.value = data.remarks || "";
  if (data.rows) {
    setRow(1, data.rows[0]);
    setRow(2, data.rows[1]);
    setRow(3, data.rows[2]);
  }
}

function saveToFile() {
  const data = getFormData();
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "CCP_OPRP_Verification.json";
  a.click();
  URL.revokeObjectURL(url);
  statusMessage.textContent = "File saved to your system.";
}

function loadFromFile(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const data = JSON.parse(e.target.result);
      setFormData(data);
      statusMessage.textContent = "File loaded successfully.";
    } catch {
      statusMessage.textContent = "Invalid file format.";
    }
  };
  reader.readAsText(file);
}

function clearForm() {
  document.querySelectorAll("input, textarea").forEach(el => {
    if (el.type !== "button" && el.type !== "file") el.value = "";
  });
  statusMessage.textContent = "Form cleared.";
}
</script>

</body>
</html>
    </div>

    <!-- SHEET 2: Buttermilk CCP & OPRP -->
    <div id="sheet2" class="tab-pane">
      <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CCP & OPRP Verification Report — Heritage Foods</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --brand: #1f4f8b;
      --ink: #222;
      --muted: #666;
      --bg: #f7f9fc;
      --line: #d9e1ee;
      --accent: #0b7;
      --warn: #c30;
    }
    html, body { margin:0; padding:0; font-family:Segoe UI, Roboto, Arial, sans-serif; color:var(--ink); background:var(--bg); }
    .wrap { max-width:1400px; margin:24px auto; background:#fff; border:1px solid var(--line); border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,.06); }
    header { padding:20px 24px; border-bottom:1px solid var(--line); }
    header h1 { margin:0 0 4px 0; font-size:20px; color:var(--brand); }
    header .meta { color:var(--muted); font-size:12px; }
    .grid { display:grid; grid-template-columns:repeat(12,1fr); gap:12px; padding:16px 24px; }
    .field { display:flex; flex-direction:column; gap:6px; }
    .field label { font-size:12px; color:var(--muted); }
    .field input, .field textarea { border:1px solid var(--line); border-radius:6px; padding:8px; font-size:13px; background:#fff; }
    .field input[readonly] { background:#f5f7fb; color:#444; }
    .section-title { padding:12px 24px; margin:8px 0 0; font-weight:600; color:var(--brand); border-top:1px solid var(--line); }
    .notice { padding:12px 24px; color:var(--muted); font-size:12px; }

    /* Table: compact, fixed layout, 100% width */
    table { width:100%; border-collapse:collapse; table-layout:fixed; margin:12px 0 24px; }
    thead th { background:#f2f6fc; color:var(--brand); font-weight:600; border-bottom:2px solid var(--line); padding:6px; font-size:12px; text-align:left; }
    tbody td { border-bottom:1px solid var(--line); padding:6px; vertical-align:middle; font-size:12px; }
    tbody tr:nth-child(even) { background:#f9fbfd; }
    .req { font-size:12px; color:var(--ink); word-wrap:break-word; }

    /* Column widths to fit 12 columns across */
    thead th:nth-child(1) { width:5%; }   /* S No */
    thead th:nth-child(2) { width:7%; }  /* Product */
    thead th:nth-child(3) { width:7%; }  /* CCP/OPRP */
    thead th:nth-child(4) { width:26%; }  /* Requirement */
    thead th:nth-child(5) { width:6%; }   /* Shift A */
    thead th:nth-child(6) { width:8%; }   /* Time A */
    thead th:nth-child(7) { width:6%; }   /* Shift B */
    thead th:nth-child(8) { width:8%; }   /* Time B */
    thead th:nth-child(9) { width:6%; }   /* Shift C */
    thead th:nth-child(10){ width:8%; }   /* Time C */
    thead th:nth-child(11){ width:6%; }   /* Shift D */
    thead th:nth-child(12){ width:8%; }   /* Time D */

    /* Inputs inside table: compact */
    tbody input[type="text"], tbody input[type="time"] { width:100%; box-sizing:border-box; padding:6px; font-size:12px; }

    .actions { display:flex; gap:10px; padding:12px 24px 24px; border-top:1px solid var(--line); flex-wrap:wrap; }
    button { padding:8px 12px; border:1px solid var(--line); border-radius:6px; background:#fff; cursor:pointer; font-size:13px; }
    button.primary { background:var(--brand); color:#fff; border-color:var(--brand); }
    button.secondary { color:var(--brand); border-color:var(--brand); }
    .footer { padding:12px 24px; border-top:1px solid var(--line); font-size:12px; color:var(--muted); display:flex; justify-content:space-between; align-items:center; }

    @media print {
      body { background:#fff; }
      .wrap { box-shadow:none; border:none; }
      .actions, .notice { display:none !important; }
      input, textarea { border:1px solid #ccc; }
      header { border-bottom:1px solid #ccc; }
    }
  </style>
</head>
<body>
  <form id="ccpForm" class="wrap">
    <header>
      <h1>HERITAGE FOODS LIMITED — CCP & OPRP Verification Report</h1>
      <div class="meta">Ref: HFL/PR/COM/R-17 | Rev No: 01 | Rev Date: 01/08/2022 | Page: 7 of 16</div>
    </header>

    <div class="grid">
      <div class="field" style="grid-column: span 3;">
        <label for="date">Date</label>
        <input type="date" id="date" name="date" required />
      </div>
      <div class="field" style="grid-column: span 5;">
        <label for="variant">Variant</label>
        <input type="text" id="variant" name="variant" placeholder="e.g., Masala Buttermilk 200 ml" required />
      </div>
      <div class="field" style="grid-column: span 4;">
        <label for="location">Location</label>
        <input type="text" id="location" name="location" placeholder="Plant / Line / Room" required />
      </div>
    </div>

    <div class="section-title">CCP & OPRP entries — Buttermilk</div>
    <div class="notice">Record readings and times at up to four checkpoints (A–D). Use 24-hour format.</div>

    <table aria-label="CCP & OPRP Verification">
      <thead>
        <tr>
          <th>S No</th>
          <th>Product</th>
          <th>CCP / OPRP</th>
          <th>Requirement</th>
          <th>Shift A</th><th>Time A</th>
          <th>Shift B</th><th>Time B</th>
          <th>Shift C</th><th>Time C</th>
          <th>Shift D</th><th>Time D</th>
        </tr>
      </thead>
      <tbody>
        <!-- 1: CCP -->
        <tr>
          <td>1</td>
          <td><input type="text" value="Butter Milk" readonly /></td>
          <td><input type="text" value="CCP 01" readonly /></td>
          <td class="req">Pasteurization of water @ 80±3 °C / 15 seconds holding</td>
          <td><input type="text" name="r1_pa" placeholder="Temp °C" /></td>
          <td><input type="time" name="r1_ta" /></td>
          <td><input type="text" name="r1_pb" placeholder="Temp °C" /></td>
          <td><input type="time" name="r1_tb" /></td>
          <td><input type="text" name="r1_pc" placeholder="Temp °C" /></td>
          <td><input type="time" name="r1_tc" /></td>
          <td><input type="text" name="r1_pd" placeholder="Temp °C" /></td>
          <td><input type="time" name="r1_td" /></td>
        </tr>

        <!-- 2: OPRP -->
        <tr>
          <td>2</td>
          <td><input type="text" value="Butter Milk" readonly /></td>
          <td><input type="text" value="OPRP 01" readonly /></td>
          <td class="req">Product thermization at 70±1 °C and cooled to < 5 °C</td>
          <td><input type="text" name="r2_pa" placeholder="Therm °C / Cool °C" /></td>
          <td><input type="time" name="r2_ta" /></td>
          <td><input type="text" name="r2_pb" placeholder="Therm °C / Cool °C" /></td>
          <td><input type="time" name="r2_tb" /></td>
          <td><input type="text" name="r2_pc" placeholder="Therm °C / Cool °C" /></td>
          <td><input type="time" name="r2_tc" /></td>
          <td><input type="text" name="r2_pd" placeholder="Therm °C / Cool °C" /></td>
          <td><input type="time" name="r2_td" /></td>
        </tr>

        <!-- 3: OPRP -->
        <tr>
          <td>3</td>
          <td><input type="text" value="Butter Milk" readonly /></td>
          <td><input type="text" value="OPRP 02" readonly /></td>
          <td class="req">Cleaning of pouch packing machines and filling machines</td>
          <td><input type="text" name="r3_pa" placeholder="Verified by / SOP ref" /></td>
          <td><input type="time" name="r3_ta" /></td>
          <td><input type="text" name="r3_pb" placeholder="Verified by / SOP ref" /></td>
          <td><input type="time" name="r3_tb" /></td>
          <td><input type="text" name="r3_pc" placeholder="Verified by / SOP ref" /></td>
          <td><input type="time" name="r3_tc" /></td>
          <td><input type="text" name="r3_pd" placeholder="Verified by / SOP ref" /></td>
          <td><input type="time" name="r3_td" /></td>
        </tr>

        <!-- 4: OPRP -->
        <tr>
          <td>4</td>
          <td><input type="text" value="Butter Milk" readonly /></td>
          <td><input type="text" value="OPRP 03" readonly /></td>
          <td class="req">Integrity check of filters (disc/nozzle/bag) in packing/filling machines</td>
          <td><input type="text" name="r4_pa" placeholder="Filter OK / Replaced" /></td>
          <td><input type="time" name="r4_ta" /></td>
          <td><input type="text" name="r4_pb" placeholder="Filter OK / Replaced" /></td>
          <td><input type="time" name="r4_tb" /></td>
          <td><input type="text" name="r4_pc" placeholder="Filter OK / Replaced" /></td>
          <td><input type="time" name="r4_tc" /></td>
          <td><input type="text" name="r4_pd" placeholder="Filter OK / Replaced" /></td>
          <td><input type="time" name="r4_td" /></td>
        </tr>

        <!-- 5: OPRP -->
        <tr>
          <td>5</td>
          <td><input type="text" value="Butter Milk" readonly /></td>
          <td><input type="text" value="OPRP 04" readonly /></td>
          <td class="req">Cold room temperature maintained ≤ 5 °C</td>
          <td><input type="text" name="r5_pa" placeholder="Room °C" /></td>
          <td><input type="time" name="r5_ta" /></td>
          <td><input type="text" name="r5_pb" placeholder="Room °C" /></td>
          <td><input type="time" name="r5_tb" /></td>
          <td><input type="text" name="r5_pc" placeholder="Room °C" /></td>
          <td><input type="time" name="r5_tc" /></td>
          <td><input type="text" name="r5_pd" placeholder="Room °C" /></td>
          <td><input type="time" name="r5_td" /></td>
        </tr>

        <!-- 6: OPRP -->
        <tr>
          <td>6</td>
          <td><input type="text" value="Butter Milk" readonly /></td>
          <td><input type="text" value="OPRP 05" readonly /></td>
          <td class="req">Heating of cut-open & flush-out curd to 60–65 °C</td>
          <td><input type="text" name="r6_pa" placeholder="Temp °C" /></td>
          <td><input type="time" name="r6_ta" /></td>
          <td><input type="text" name="r6_pb" placeholder="Temp °C" /></td>
          <td><input type="time" name="r6_tb" /></td>
          <td><input type="text" name="r6_pc" placeholder="Temp °C" /></td>
          <td><input type="time" name="r6_tc" /></td>
          <td><input type="text" name="r6_pd" placeholder="Temp °C" /></td>
          <td><input type="time" name="r6_td" /></td>
        </tr>
      </tbody>
    </table>

    <div class="grid">
      <div class="field" style="grid-column: span 12;">
        <label for="remarks">Remarks</label>
        <textarea id="remarks" name="remarks" rows="3" placeholder="Observations, deviations, corrective actions"></textarea>
      </div>
    </div>

    <div class="footer">
      <div>QA In-charge</div>
      <!-- Signatures removed as requested -->
    </div>

    <div class="actions">
      <button type="button" class="secondary" onclick="window.print()">Print</button>
      <button type="submit" class="primary">Validate & Export JSON</button>
      <button type="button" onclick="clearForm()">Clear</button>

      <!-- Load File -->
      <input type="file" id="loadFile" accept="application/json" style="display:none" />
      <button type="button" onclick="document.getElementById('loadFile').click()">Load File</button>
    </div>

    <div class="notice" id="status"></div>
  </form>

  <script>
    // Autofill today’s date
    (function init() {
      const date = document.getElementById('date');
      if (!date.value) {
        const today = new Date().toISOString().slice(0,10);
        date.value = today;
      }
    })();

    // Validation + JSON export (no signatures)
    document.getElementById('ccpForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const status = document.getElementById('status');

      const requiredIds = ['date', 'variant', 'location'];
      for (const id of requiredIds) {
        const el = document.getElementById(id);
        if (!el.value.trim()) {
          status.textContent = `Missing required field: ${id}`;
          status.style.color = 'var(--warn)';
          el.focus();
          return;
        }
      }

      const data = {
        header: {
          ref: 'HFL/PR/COM/R-17',
          revNo: '01',
          revDate: '01/08/2022',
          page: '7 of 16',
          date: document.getElementById('date').value,
          variant: document.getElementById('variant').value.trim(),
          location: document.getElementById('location').value.trim()
        },
        rows: []
      };

      const rowDefs = [
        { n:1, product:'Butter Milk', code:'CCP 01', req:'Pasteurization of water @ 80±3 °C / 15 seconds holding' },
        { n:2, product:'Butter Milk', code:'OPRP 01', req:'Product thermization at 70±1 °C and cooled to < 5 °C' },
        { n:3, product:'Butter Milk', code:'OPRP 02', req:'Cleaning of pouch packing machines and filling machines' },
        { n:4, product:'Butter Milk', code:'OPRP 03', req:'Integrity check of filters (disc/nozzle/bag) in packing/filling machines' },
        { n:5, product:'Butter Milk', code:'OPRP 04', req:'Cold room temperature maintained ≤ 5 °C' },
        { n:6, product:'Butter Milk', code:'OPRP 05', req:'Heating of cut-open & flush-out curd to 60–65 °C' }
      ];

      for (const r of rowDefs) {
        const row = {
          sNo: r.n,
          product: r.product,
          code: r.code,
          requirement: r.req,
          checkpoints: [
            { value: get(`r${r.n}_pa`), time: get(`r${r.n}_ta`) },
            { value: get(`r${r.n}_pb`), time: get(`r${r.n}_tb`) },
            { value: get(`r${r.n}_pc`), time: get(`r${r.n}_tc`) },
            { value: get(`r${r.n}_pd`), time: get(`r${r.n}_td`) }
          ]
        };
        data.rows.push(row);
      }

      data.remarks = document.getElementById('remarks').value.trim();

      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      const dt = data.header.date.replace(/-/g, '');
      a.href = url;
      a.download = `CCP_OPRP_${data.header.variant.replace(/\s+/g,'_')}_${dt}.json`;
      document.body.appendChild(a);
      a.click();
      URL.revokeObjectURL(url);
      a.remove();

      status.textContent = 'Exported JSON successfully.';
      status.style.color = 'var(--accent)';

      function get(name) {
        const el = document.getElementsByName(name)[0];
        return el ? el.value.trim() : '';
      }
    });

    // Load JSON back into form
    document.getElementById('loadFile').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      const status = document.getElementById('status');
      const reader = new FileReader();

      reader.onload = function(evt) {
        try {
          const data = JSON.parse(evt.target.result);

          // Basic structure check
          if (!data.header || !Array.isArray(data.rows)) {
            throw new Error('Invalid structure');
          }

          // Header
          document.getElementById('date').value = data.header.date || '';
          document.getElementById('variant').value = data.header.variant || '';
          document.getElementById('location').value = data.header.location || '';

          // Rows (expect sNo 1..6)
          for (const row of data.rows) {
            const n = row.sNo;
            const cps = row.checkpoints || [];
            const set = (name, val) => {
              const el = document.getElementsByName(name)[0];
              if (el) el.value = val || '';
            };
            if (n >= 1 && n <= 6) {
              set(`r${n}_pa`, cps[0]?.value);
              set(`r${n}_ta`, cps[0]?.time);
              set(`r${n}_pb`, cps[1]?.value);
              set(`r${n}_tb`, cps[1]?.time);
              set(`r${n}_pc`, cps[2]?.value);
              set(`r${n}_tc`, cps[2]?.time);
              set(`r${n}_pd`, cps[3]?.value);
              set(`r${n}_td`, cps[3]?.time);
            }
          }

          // Remarks
          document.getElementById('remarks').value = data.remarks || '';

          status.textContent = 'File loaded successfully.';
          status.style.color = 'var(--accent)';
        } catch (err) {
          status.textContent = 'Invalid JSON file.';
          status.style.color = 'var(--warn)';
        } finally {
          // Reset file input to allow loading same file again if needed
          e.target.value = '';
        }
      };

      reader.readAsText(file);
    });

    // Clear form and set date to today
    function clearForm() {
      const form = document.getElementById('ccpForm');
      form.reset();
      const today = new Date().toISOString().slice(0,10);
      document.getElementById('date').value = today;
      document.getElementById('status').textContent = '';
    }
  </script>
</body>
</html>
    </div>

    <!-- SHEET 3: Curd CCP & OPRP -->
    <div id="sheet3" class="tab-pane">
      <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>HERITAGE FOODS — CCP & OPRP Verification Report (Curd)</title>
<style>
  body { font-family: Arial, sans-serif; margin:20px; }
  header { text-align:center; border-bottom:2px solid #0b6fb3; margin-bottom:16px; }
  header h1 { margin:0; color:#0b6fb3; font-size:20px; }
  header .meta { margin-top:6px; font-size:14px; color:#555; }
  .header-line { display:flex; flex-wrap:wrap; gap:12px; align-items:center; margin:12px 0; }
  .header-line label { font-size:14px; color:#333; }
  .header-line input[type="text"], .header-line input[type="date"] {
    padding:6px 8px; font-size:14px;
  }
  .toolbar { margin:10px 0; text-align:center; display:flex; gap:8px; justify-content:center; flex-wrap:wrap; }
  button { padding:8px 12px; border:1px solid #0b6fb3; background:#0b6fb3; color:#fff; border-radius:6px; cursor:pointer; }
  button.secondary { background:#fff; color:#0b6fb3; }
  .status { text-align:center; font-size:13px; margin-top:6px; }
  .status.ok { color:#197b30; }
  .status.err { color:#b33a3a; }

  table { border-collapse:collapse; width:100%; table-layout:auto; }
  th, td { border:1px solid #ccc; padding:8px; vertical-align:top; word-wrap:break-word; }
  th { background:#f0f0f0; }
  input[type="time"], input[type="text"] { width:100%; box-sizing:border-box; padding:6px; font-size:14px; }
  textarea { width:100%; min-height:50px; padding:8px; font-size:14px; box-sizing:border-box; }

  @media print {
    .toolbar, .status { display:none !important; }
  }
</style>
</head>
<body>
<header>
  <h1>HERITAGE FOODS LIMITED — CCP & OPRP Verification Report</h1>
  <div class="meta">Rev No: 01 | Rev Date: 01/08/2022 | Ref No: HFL/PR/COM/R - 17 | Page No: 6 of 16</div>
</header>

<!-- Single-line header inputs -->
<div class="header-line">
  <label>Date: <input type="date" id="hdrDate"></label>
  <label>Variant: <input type="text" id="hdrVariant" size="16" placeholder="e.g., 500g pouch"></label>
  <label>Location: <input type="text" id="hdrLocation" size="16" placeholder="Plant / Line"></label>
  <label>Product: <input type="text" id="hdrProduct" value="Curd" size="16"></label>
</div>

<div class="toolbar">
  <button type="button" id="btnSave">Save (JSON)</button>
  <button type="button" class="secondary" id="btnLoad">Load</button>
  <input type="file" id="fileInput" accept=".json,application/json" style="display:none">
  <button type="button" class="secondary" id="btnPrint">Print</button>
  <button type="button" class="secondary" id="btnClear">Clear</button>
</div>
<div id="status" class="status" role="status" aria-live="polite"></div>

<table>
  <thead>
    <tr>
      <th>S No</th><th>Product</th><th>CCP & OPRP</th><th>Requirement</th>
      <th>Time1</th><th>Param1</th>
      <th>Time2</th><th>Param2</th>
      <th>Time3</th><th>Param3</th>
      <th>Time4</th><th>Param4</th>
    </tr>
  </thead>
  <tbody>
    <!-- Row 1 -->
    <tr>
      <td>1</td><td>Curd</td><td>CCP 01</td>
      <td>Pasteurization of Curd Milk @ 92±2 ℃ / 6 or 10 minutes Holding</td>
      <td><input type="time" id="r1_t1"></td><td><input type="text" id="r1_p1" placeholder="Temp ℃ / Hold min"></td>
      <td><input type="time" id="r1_t2"></td><td><input type="text" id="r1_p2" placeholder="Temp ℃ / Hold min"></td>
      <td><input type="time" id="r1_t3"></td><td><input type="text" id="r1_p3" placeholder="Temp ℃ / Hold min"></td>
      <td><input type="time" id="r1_t4"></td><td><input type="text" id="r1_p4" placeholder="Temp ℃ / Hold min"></td>
    </tr>
    <!-- Row 2 -->
    <tr>
      <td>2</td><td>Curd</td><td>OPRP 01</td>
      <td>Cleaning of Pouch Packing Machines and Filling Machines</td>
      <td><input type="time" id="r2_t1"></td><td><input type="text" id="r2_p1" placeholder="Status/Reference"></td>
      <td><input type="time" id="r2_t2"></td><td><input type="text" id="r2_p2" placeholder="Status/Reference"></td>
      <td><input type="time" id="r2_t3"></td><td><input type="text" id="r2_p3" placeholder="Status/Reference"></td>
      <td><input type="time" id="r2_t4"></td><td><input type="text" id="r2_p4" placeholder="Status/Reference"></td>
    </tr>
    <!-- Row 3 -->
    <tr>
      <td>3</td><td>Curd</td><td>OPRP 02</td>
      <td>Checking the Integrity of Filters (Disc/ Nozzle/ Bag) in Packing/ Filling machines</td>
      <td><input type="time" id="r3_t1"></td><td><input type="text" id="r3_p1" placeholder="OK/Replace/Notes"></td>
      <td><input type="time" id="r3_t2"></td><td><input type="text" id="r3_p2" placeholder="OK/Replace/Notes"></td>
      <td><input type="time" id="r3_t3"></td><td><input type="text" id="r3_p3" placeholder="OK/Replace/Notes"></td>
      <td><input type="time" id="r3_t4"></td><td><input type="text" id="r3_p4" placeholder="OK/Replace/Notes"></td>
    </tr>
    <!-- Row 4 -->
    <tr>
      <td>4</td><td>Curd</td><td>OPRP 03</td>
      <td>Shifting of curd to Cold store after attaining required acidity level</td>
      <td><input type="time" id="r4_t1"></td><td><input type="text" id="r4_p1" placeholder="Acidity % / Status"></td>
      <td><input type="time" id="r4_t2"></td><td><input type="text" id="r4_p2" placeholder="Acidity % / Status"></td>
      <td><input type="time" id="r4_t3"></td><td><input type="text" id="r4_p3" placeholder="Acidity % / Status"></td>
      <td><input type="time" id="r4_t4"></td><td><input type="text" id="r4_p4" placeholder="Acidity % / Status"></td>
    </tr>
    <!-- Row 5 -->
    <tr>
      <td>5</td><td>Curd</td><td>OPRP 04</td>
      <td>Curd Cold Room Temperature to be maintained ≤ 5 ℃</td>
      <td><input type="time" id="r5_t1"></td><td><input type="text" id="r5_p1" placeholder="Temp ℃"></td>
      <td><input type="time" id="r5_t2"></td><td><input type="text" id="r5_p2" placeholder="Temp ℃"></td>
      <td><input type="time" id="r5_t3"></td><td><input type="text" id="r5_p3" placeholder="Temp ℃"></td>
      <td><input type="time" id="r5_t4"></td><td><input type="text" id="r5_p4" placeholder="Temp ℃"></td>
    </tr>
  </tbody>
</table>

<div style="margin-top:12px;">
  <label>Remarks</label>
  <textarea id="remarks" placeholder="Observations, deviations, corrective actions"></textarea>
</div>

<script>
(function(){
  const statusEl = document.getElementById('status');
  const fileInput = document.getElementById('fileInput');

  function showStatus(msg, ok=false){
    statusEl.textContent = msg;
    statusEl.className = 'status ' + (ok ? 'ok' : 'err');
    if(ok){ setTimeout(()=>{ statusEl.textContent=''; statusEl.className='status'; }, 2500); }
  }

  function todayISO(){
    const d = new Date(); const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const day=String(d.getDate()).padStart(2,'0');
    return `${y}-${m}-${day}`;
  }

  function collectData(){
    return {
      meta:{ revNo:'01', revDate:'01/08/2022', refNo:'HFL/PR/COM/R - 17', pageNo:'6 of 16', savedAt:new Date().toISOString() },
      header:{
        date: document.getElementById('hdrDate').value || '',
        variant: document.getElementById('hdrVariant').value || '',
        location: document.getElementById('hdrLocation').value || '',
        product: document.getElementById('hdrProduct').value || ''
      },
      rows: [1,2,3,4,5].map(i=>({
        sNo:i,
        times:[1,2,3,4].map(j=>document.getElementById(`r${i}_t${j}`)?.value || ''),
        params:[1,2,3,4].map(j=>document.getElementById(`r${i}_p${j}`)?.value || '')
      })),
      remarks: document.getElementById('remarks').value || ''
    };
  }

  function validateBasic(){
    const h = collectData().header;
    if(!h.date || !h.variant || !h.location){
      showStatus('Please fill Date, Variant, and Location before saving.');
      return false;
    }
    return true;
  }

  function saveLocal(){
    try{
      if(!validateBasic()) return;
      const data = collectData();
      const variantSafe = (data.header.variant || 'variant').replace(/[^a-z0-9]+/gi,'_');
      const locationSafe = (data.header.location || 'location').replace(/[^a-z0-9]+/gi,'_');
      const dateSafe = (data.header.date || todayISO());
      const filename = `Curd_CCP_OPRP_${dateSafe}_${variantSafe}_${locationSafe}.json`;

      const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = filename;
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
      showStatus('Saved: ' + filename, true);
    } catch(e){
      console.error(e); showStatus('Save failed.');
    }
  }

  function loadLocal(file){
    const reader = new FileReader();
    reader.onload = (e)=>{
      try{
        const data = JSON.parse(e.target.result);
        // Header
        document.getElementById('hdrDate').value = data.header?.date || '';
        document.getElementById('hdrVariant').value = data.header?.variant || '';
        document.getElementById('hdrLocation').value = data.header?.location || '';
        document.getElementById('hdrProduct').value = data.header?.product || 'Curd';
        // Rows
        (data.rows || []).forEach(r=>{
          for(let j=1;j<=4;j++){
            const t = r.times?.[j-1] || ''; const p = r.params?.[j-1] || '';
            const tEl = document.getElementById(`r${r.sNo}_t${j}`); const pEl = document.getElementById(`r${r.sNo}_p${j}`);
            if(tEl) tEl.value = t; if(pEl) pEl.value = p;
          }
        });
        // Remarks
        document.getElementById('remarks').value = data.remarks || '';
        showStatus('Data loaded.', true);
      } catch(err){
        console.error(err); showStatus('Invalid JSON file.');
      }
    };
    reader.onerror = ()=> showStatus('Could not read file.');
    reader.readAsText(file);
  }

  function clearAll(){
    if(!confirm('Clear all entries?')) return;
    document.querySelectorAll('input[type="text"], input[type="time"], input[type="date"], textarea')
      .forEach(el=>{
        if(el.id==='hdrProduct'){ el.value='Curd'; return; }
        if(el.id==='hdrDate'){ el.value=todayISO(); return; }
        el.value='';
      });
    showStatus('Form cleared.', true);
  }

  // Bind after DOM is ready
  window.addEventListener('DOMContentLoaded', ()=>{
    // Default date today
    if(!document.getElementById('hdrDate').value){ document.getElementById('hdrDate').value = todayISO(); }

    document.getElementById('btnSave').addEventListener('click', saveLocal);
    document.getElementById('btnLoad').addEventListener('click', ()=> fileInput.click());
    document.getElementById('btnPrint').addEventListener('click', ()=> window.print());
    document.getElementById('btnClear').addEventListener('click', clearAll);

    fileInput.addEventListener('change', (e)=>{
      const file = e.target.files && e.target.files[0];
      if(file) loadLocal(file);
      e.target.value = ''; // allow re-selecting same file
    });
  });
})();
</script>
</body>
</html>
    </div>
  </div>
</div>

<script>
  document.querySelectorAll('.tab-link').forEach(function (btn) {
    btn.addEventListener('click', function () {
      var targetId = this.getAttribute('data-target');

      document.querySelectorAll('.tab-link').forEach(function (b) {
        b.classList.remove('active');
      });
      this.classList.add('active');

      document.querySelectorAll('.tab-pane').forEach(function (pane) {
        pane.classList.remove('active');
      });
      var pane = document.getElementById(targetId);
      if (pane) { pane.classList.add('active'); }
    });
  });
</script>

</body>
</html>
